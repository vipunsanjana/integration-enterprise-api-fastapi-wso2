(this.webpackChunk_wso2apim_devportal=this.webpackChunk_wso2apim_devportal||[]).push([[6180],{355720:(e,t,n)=>{"use strict";var a=n(122411);t.c=void 0;var i=a(n(493540)),o=n(617624);t.c=(0,i.default)((0,o.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline")},607064:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ke});var a=n(811504),i=n(906940),o=n(203268),s=n.n(o),r=n(924004),l=n(162248),c=n(542592),m=n(715656),d=n(902706),p=n(991568),h=n(404292),u=n(153032),g=n(458130),C=n(971192),f=n(687372),y=n(355720),b=n(969072),v=n(226120),w=n(205420),E=n(362264),$=n.n(E),k=n(677336),M=n.n(k),T=n(482084),S=n.n(T),D=n(141776),x=n(758872),A=n(217729),O=n(212576),R=n(40928),I=n(153328);const W="ConfirmDialog",N={dialogWrapper:`${W}-dialogWrapper`,deleteConformButton:`${W}-deleteConformButton`},L=(0,i.cp)(x.c)((e=>{let{theme:t}=e;return{[`&.${N.dialogWrapper}`]:{"& span, & h5, & label, & td, & li, & div, & p":{color:t.palette.getContrastText(t.palette.background.paper)}},[`& .${N.deleteConformButton}`]:{"& span.MuiButton-label":{color:t.palette.getContrastText(t.palette.primary.main)}}}}));class q extends a.Component{handleRequestClose(e){const{callback:t}=this.props;e===q.Action.OK?t(!0):t(!1)}render(){const{title:e,message:t,labelCancel:n,labelOk:i,open:o}=this.props;return a.createElement(L,{role:"alertdialog",open:o,onClose:this.handleRequestClose,className:N.dialogWrapper},a.createElement(A.c,null,e||a.createElement(h.c,{id:"Shared.ConfirmDialog.please.confirm",defaultMessage:"Please Confirm"})),a.createElement(O.c,null,a.createElement(R.c,null,t||a.createElement(h.c,{id:"Shared.ConfirmDialog.please.confirm.sure",defaultMessage:"Are you sure?"}))),a.createElement(I.c,null,a.createElement(d.c,{onClick:()=>this.handleRequestClose(q.Action.CANCEL),color:"grey"},n||a.createElement(h.c,{id:"Shared.ConfirmDialog.cancel",defaultMessage:"Cancel"})),a.createElement(d.c,{onClick:()=>this.handleRequestClose(q.Action.OK),color:"primary",variant:"contained",className:N.deleteConformButton},i||a.createElement(h.c,{id:"Shared.ConfirmDialog.ok",defaultMessage:"OK"}))))}}q.propTypes={title:s().string.isRequired,message:s().string.isRequired,labelCancel:s().string.isRequired,labelOk:s().string.isRequired,callback:s().func.isRequired,open:s().bool.isRequired},q.Action={OK:"ok",CANCEL:"cancel"};const U=q;var B=n(273384),P=n(622037),j=n(377384),_=n(340056),F=n(910288);const Y="CommentEditLegacy",z={textField:`${Y}-textField`,contentWrapper:`${Y}-contentWrapper`,category:`${Y}-category`},H=(0,i.cp)("div")((e=>{let{theme:t}=e;return{[`& .${z.textField}`]:{marginTop:0,width:"87.5%"},[`& .${z.contentWrapper}`]:{maxWidth:t.custom.contentAreaWidth,paddingLeft:t.spacing(2),paddingTop:t.spacing.unig,marginTop:t.spacing(2)},[`& .${z.category}`]:{width:"12%",marginRight:"0.5%"}}}));class K extends a.Component{constructor(e){super(e),this.state={commentText:"",category:"",currentLength:0},this.inputChange=this.inputChange.bind(this),this.handleCategoryChange=this.handleCategoryChange.bind(this),this.handleClickUpdateComment=this.handleClickUpdateComment.bind(this),this.handleClickCancel=this.handleClickCancel.bind(this),this.filterCommentToUpdate=this.filterCommentToUpdate.bind(this),this.filterCommentToUpdateReply=this.filterCommentToUpdateReply.bind(this)}componentDidMount(){const{comment:e}=this.props;this.setState({commentText:e.commentText,category:e.category,currentLength:e.commentText.length})}inputChange(e){let{target:t}=e;this.setState({commentText:t.value,currentLength:t.value.length})}handleClickCancel(){const{toggleShowEdit:e,commentsUpdate:t,allComments:n}=this.props;e(),t(n)}handleCategoryChange(e){this.setState({category:e.target.value})}filterCommentToUpdate(e){const{comment:t}=this.props;return e.commentId===t.commentId}filterCommentToUpdateReply(e){const{comment:t}=this.props;return e.commentId===t.parentCommentId}handleClickUpdateComment(){const{apiId:e,comment:t,allComments:n,toggleShowEdit:a,commentsUpdate:i,intl:o}=this.props,{category:s,commentText:r}=this.state,l=new B.c,c=t;c.commentText=r.trim(),c.category=s,t.commentText.replace(/\s/g,"").length?l.updateComment(e,c.commentId,c).then((e=>{const t=e.body;if(void 0===c.parentCommentId){const e=n.findIndex(this.filterCommentToUpdate);n[e].category=t.category,n[e].commentText=t.commentText}else{const e=n.findIndex(this.filterCommentToUpdateReply),a=n[e].replies.findIndex(this.filterCommentToUpdate);n[e].replies[a]=t}a(),i(n)})).catch((e=>{console.error(e),e.response?D.c.error(e.response.body.message):D.c.error(o.formatMessage({defaultMessage:"Something went wrong while adding the comment",id:"Apis.Details.Comments.CommentEdit.something.went.wrong"}))})):D.c.error(o.formatMessage({defaultMessage:"You cannot enter a blank comment",id:"Apis.Details.Comments.CommentEdit.blank.comment.error"}))}render(){const{theme:e,intl:t}=this.props,{category:n,commentText:i,currentLength:o}=this.state;return a.createElement(H,null,a.createElement(j.c,{variant:"standard",className:z.category},a.createElement(F.c,{variant:"standard",value:n,onChange:this.handleCategoryChange},a.createElement(_.c,{value:"General"},a.createElement(h.c,{id:"Apis.Details.Comments.CommentEdit.general",defaultMessage:"General"})),a.createElement(_.c,{value:"Feature Request"},a.createElement(h.c,{id:"Apis.Details.Comments.CommentEdit.feature.request",defaultMessage:"Feature Request"})),a.createElement(_.c,{value:"Bug Report"},a.createElement(h.c,{id:"Apis.Details.Comments.CommentEdit.bug.report",defaultMessage:"Bug Report"})))),a.createElement(P.c,{variant:"standard",id:"multiline-static",autoFocus:!0,multiline:!0,className:z.textField,margin:"normal",placeholder:t.formatMessage({defaultMessage:"Write a comment",id:"Apis.Details.Comments.CommentEdit.write.a.comment"}),inputProps:{maxLength:e.custom.maxCommentLength},value:i,onChange:this.inputChange}),a.createElement(l.c,{className:z.commentText,align:"right"},o+"/"+e.custom.maxCommentLength),a.createElement(m.cp,{container:!0,spacing:1},a.createElement(m.cp,{item:!0},a.createElement(d.c,{variant:"contained",color:"primary",onClick:()=>this.handleClickUpdateComment()},a.createElement(h.c,{id:"Apis.Details.Comments.CommentEdit.btn.save",defaultMessage:"Save"}))),a.createElement(m.cp,{item:!0},a.createElement(d.c,{onClick:()=>this.handleClickCancel(),className:z.button},a.createElement(h.c,{id:"Apis.Details.Comments.CommentEdit.btn.cancel",defaultMessage:"Cancel"})))))}}K.defaultProps={commentsUpdate:null},K.propTypes={classes:s().instanceOf(Object).isRequired,apiId:s().string.isRequired,allComments:s().instanceOf(Array).isRequired,commentsUpdate:s().func,toggleShowEdit:s().func.isRequired,comment:s().instanceOf(Object).isRequired,intl:s().shape({formatMessage:s().func}).isRequired};const J=(0,u.cp)((function(e){const{comment:t,toggleShowEdit:n,commentsUpdate:i,allComments:o,apiId:s,intl:r}=e,l=(0,c.c)();return a.createElement(K,{comment:t,toggleShowEdit:n,commentsUpdate:i,allComments:o,apiId:s,intl:r,theme:l})}));var Z=n(669872);const V="CommentOptions",G={link:`${V}-link`,time:`${V}-time`,verticalSpace:`${V}-verticalSpace`,disable:`${V}-disable`,commentIcon:`${V}-commentIcon`,commentText:`${V}-commentText`,root:`${V}-root`,contentWrapper:`${V}-contentWrapper`},Q=(0,i.cp)(m.cp)((e=>{let{theme:t}=e;return{[`& .${G.link}`]:{fontWeight:400,"& span.MuiButton-label":{color:t.palette.primary.main,fontWeight:"400"},cursor:"pointer"},[`& .${G.time}`]:{color:t.palette.getContrastText(t.palette.background.default),marginTop:t.spacing(.3)},[`&.${G.verticalSpace}`]:{display:"flex",alignItems:"center"},[`& .${G.disable}`]:{color:t.palette.grey[200]},[`& .${G.commentIcon}`]:{color:t.palette.getContrastText(t.palette.background.default)},[`& .${G.commentText}`]:{color:t.palette.getContrastText(t.palette.background.default),marginTop:t.spacing.unig,width:"100%",whiteSpace:"pre-wrap",overflowWrap:"break-word"},[`& .${G.root}`]:{marginTop:t.spacing(2.5)},[`& .${G.contentWrapper}`]:{maxWidth:t.custom.contentAreaWidth,paddingLeft:t.spacing(2),paddingTop:t.spacing.unig}}}));class X extends a.Component{constructor(e){super(e),this.state={},this.showAddComment=this.showAddComment.bind(this),this.showEditComment=this.showEditComment.bind(this),this.handleClickOpen=this.handleClickOpen.bind(this)}showAddComment(e){const{showAddComment:t}=this.props;t(e)}showEditComment(e){const{editIndex:t,showEditComment:n}=this.props;-1===t&&n(e)}handleClickOpen(e){const{editIndex:t,handleClickOpen:n}=this.props;-1===t&&n(e)}displayDate(e){const t=new Date(e);return t.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})+" "+t.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}render(){const{comment:e,editIndex:t}=this.props,n=Z.c.getUser(),i=n&&n.name,o=e.createdBy===i||n&&n.isAdmin();return a.createElement(Q,{container:!0,className:G.verticalSpace,key:e.id},o&&[a.createElement(m.cp,{item:!0,key:"key-delete"},a.createElement(d.c,{size:"small",className:-1===t?G.link:G.disable,onClick:()=>this.handleClickOpen(e),color:"primary","aria-label":"Delete comment "+e.content},a.createElement(h.c,{id:"Apis.Details.Comments.CommentOptions.delete",defaultMessage:"Delete"})))],null===e.parentCommentId&&Z.c.getUser()&&[a.createElement(m.cp,{item:!0,key:"key-reply"},a.createElement(d.c,{size:"small",className:G.link,onClick:()=>this.showAddComment(e.id),color:"primary","aria-label":"Reply to comment "+e.content},a.createElement(h.c,{id:"Apis.Details.Comments.CommentOptions.reply",defaultMessage:"Reply"})))])}}X.defaultProps={showAddComment:null},X.propTypes={classes:s().instanceOf(Object).isRequired,editIndex:s().number.isRequired,index:s().number.isRequired,comment:s().instanceOf(Object).isRequired,handleClickOpen:s().func.isRequired,showEditComment:s().func.isRequired,showAddComment:s().func};const ee=X;var te=n(981392);const ne="CommentAddLegacy",ae={commentIcon:`${ne}-commentIcon`,content:`${ne}-content`,contentWrapper:`${ne}-contentWrapper`,textField:`${ne}-textField`,commentAddWrapper:`${ne}-commentAddWrapper`,commentAddButton:`${ne}-commentAddButton`},ie=(0,i.cp)(m.cp)((e=>{let{theme:t}=e;return{[`& .${ae.commentIcon}`]:{color:t.palette.getContrastText(t.palette.background.default)},[`& .${ae.content}`]:{color:t.palette.getContrastText(t.palette.background.default)},[`&.${ae.contentWrapper}`]:{maxWidth:t.custom.contentAreaWidth,paddingLeft:t.spacing(2),paddingTop:t.spacing(1),marginTop:t.spacing(2)},[`& .${ae.textField}`]:{marginTop:0,marginRight:5,width:"100%"},[`& .${ae.commentAddWrapper}`]:{display:"flex",alignItems:"top",flexFlow:"column","& label":{marginBottom:t.spacing(1)}},[`& .${ae.commentAddButton}`]:{"& span.MuiButton-label":{color:t.palette.getContrastText(t.palette.primary.main)}}}}));class oe extends a.Component{constructor(e){super(e),function(e,t,n){var a;(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?a:String(a))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"handleCancel",(()=>{const{cancelCallback:e}=this.props;e?e():this.handleClickCancel(-1)})),this.state={content:"",currentLength:0},this.inputChange=this.inputChange.bind(this),this.handleClickAddComment=this.handleClickAddComment.bind(this),this.handleClickCancel=this.handleClickCancel.bind(this),this.filterCommentToAddReply=this.filterCommentToAddReply.bind(this)}inputChange(e){let{target:t}=e;this.setState({content:t.value,currentLength:t.value.length})}handleClickCancel(){this.setState({content:""});const{handleShowReply:e}=this.props;e(-1)}filterCommentToAddReply(e){const{replyTo:t}=this.props;return e.id===t}handleClickAddComment(){const{apiId:e,intl:t,replyTo:n,handleShowReply:a,addComment:i,addReply:o}=this.props,{content:s}=this.state,r=new B.c,l={content:s.trim(),category:"general"};l.content.replace(/\s/g,"").length?r.addComment(e,l,n).then((e=>{this.setState({content:""}),null===n?i&&i(e.body):o&&o(e.body)})).catch((e=>{console.error(e),e.response&&e.response.body&&e.response.body.message?D.c.error(e.response.body.message):D.c.error(t.formatMessage({defaultMessage:"Something went wrong while adding the comment",id:"Apis.Details.Comments.CommentAdd.something.went.wrong"}))})):D.c.error(t.formatMessage({defaultMessage:"You cannot enter a blank comment",id:"Apis.Details.Comments.CommentAdd.error.blank.comment"})),this.setState({currentLength:0}),null!==n&&a()}render(){const{cancelButton:e,theme:t,intl:n}=this.props,{content:i,currentLength:o}=this.state;return a.createElement(ie,{container:!0,spacing:1,className:ae.contentWrapper},a.createElement(m.cp,{item:!0,xs:!0,zeroMinWidth:!0},a.createElement("div",{className:ae.commentAddWrapper},a.createElement(te.c,{htmlFor:"standard-multiline-flexible"},a.createElement(h.c,{id:"Apis.Details.Comments.CommentAdd.write.comment.label",defaultMessage:"Write a comment"})),a.createElement(P.c,{id:"standard-multiline-flexible",autoFocus:!0,multiline:!0,rows:"4",className:ae.textField,margin:"normal",placeholder:n.formatMessage({defaultMessage:"Write a comment",id:"Apis.Details.Comments.CommentAdd.write.comment.help"}),inputProps:{maxLength:t.custom.maxCommentLength},value:i,onChange:this.inputChange,variant:"outlined"}),a.createElement(l.c,{className:ae.content,align:"right"},o+"/"+t.custom.maxCommentLength)),a.createElement(m.cp,{container:!0,spacing:1},a.createElement(m.cp,{item:!0},a.createElement(d.c,{variant:"contained",color:"primary",disabled:0===o,onClick:()=>this.handleClickAddComment(),className:ae.commentAddButton},a.createElement(h.c,{id:"Apis.Details.Comments.CommentAdd.btn.add.comment",defaultMessage:"Comment"}))),e&&a.createElement(m.cp,{item:!0},a.createElement(d.c,{onClick:this.handleCancel,color:"grey",className:ae.button},a.createElement(h.c,{id:"Apis.Details.Comments.CommentAdd.btn.cancel",defaultMessage:"Cancel"}))))))}}oe.defaultProps={replyTo:null,handleShowReply:null,commentsUpdate:null,cancelCallback:null},oe.propTypes={classes:s().instanceOf(Object).isRequired,cancelButton:s().bool.isRequired,apiId:s().string.isRequired,replyTo:s().string,handleShowReply:s().func,commentsUpdate:s().func,allComments:s().instanceOf(Array).isRequired,intl:s().shape({formatMessage:s().func}).isRequired,cancelCallback:s().func};const se=(0,u.cp)((function(e){const{handleShowReply:t,replyTo:n,apiId:i,intl:o,addComment:s,addReply:r,cancelCallback:l,cancelButton:m}=e,d=(0,c.c)();return a.createElement(oe,{handleShowReply:t,replyTo:n,apiId:i,intl:o,addComment:s,addReply:r,cancelCallback:l,cancelButton:m,theme:d})}));function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ce(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?a:String(a))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}$().extend(M());const me="Comment",de={link:`${me}-link`,commentIcon:`${me}-commentIcon`,commentText:`${me}-commentText`,root:`${me}-root`,contentWrapper:`${me}-contentWrapper`,contentWrapperOverview:`${me}-contentWrapperOverview`,divider:`${me}-divider`,paper:`${me}-paper`,cleanBack:`${me}-cleanBack`},pe=(0,i.cp)("div")((e=>{let{theme:t}=e;return{[`& .${de.link}`]:{color:t.palette.getContrastText(t.palette.background.default),cursor:"pointer"},[`& .${de.commentIcon}`]:{color:t.palette.getContrastText(t.palette.background.default)},[`& .${de.commentText}`]:{color:t.palette.getContrastText(t.palette.background.default),marginTop:0,width:"99%",whiteSpace:"pre-wrap",overflowWrap:"break-word",wordBreak:"break-all"},[`& .${de.root}`]:{marginTop:t.spacing(1)},[`& .${de.contentWrapper}`]:{paddingLeft:t.spacing(2),paddingTop:t.spacing(1)},[`& .${de.contentWrapperOverview}`]:{background:"transparent",width:"100%"},[`& .${de.divider}`]:{marginTop:t.spacing(2),marginBottom:t.spacing(2),width:"60%"},[`& .${de.paper}`]:{margin:0,marginTop:t.spacing(1),marginRight:t.spacing(3),paddingBottom:t.spacing(3)},[`& .${de.cleanBack}`]:{background:"transparent",width:"100%",boxShadow:"none"}}}));class he extends a.Component{constructor(e){super(e),this.state={openDialog:!1,replyId:-1,editIndex:-1,deleteComment:null},this.handleClickDeleteComment=this.handleClickDeleteComment.bind(this),this.handleShowEdit=this.handleShowEdit.bind(this),this.handleShowReply=this.handleShowReply.bind(this),this.handleClickOpen=this.handleClickOpen.bind(this),this.showAddComment=this.showAddComment.bind(this),this.showEditComment=this.showEditComment.bind(this),this.handleConfirmDialog=this.handleConfirmDialog.bind(this),this.handleClose=this.handleClose.bind(this),this.filterRemainingComments=this.filterRemainingComments.bind(this),this.filterCommentToDelete=this.filterCommentToDelete.bind(this),this.handleLoadMoreReplies=this.handleLoadMoreReplies.bind(this),this.handleAddReply=this.handleAddReply.bind(this),this.handleDeleteReply=this.handleDeleteReply.bind(this)}filterRemainingComments(e){const{deleteComment:t}=this.state;return e.id!==t.id}filterCommentToDelete(e){const{deleteComment:t}=this.state;return e.id===t.parentCommentId}showAddComment(e){this.setState({replyId:e})}showEditComment(e){const{editIndex:t}=this.state;-1===t&&this.setState({editIndex:e})}handleShowEdit(){this.setState({editIndex:-1})}handleShowReply(){this.setState({replyId:-1})}handleClickOpen(e){const{editIndex:t}=this.state;-1===t&&this.setState({deleteComment:e,openDialog:!0})}handleClose(){this.setState({openDialog:!1})}handleConfirmDialog(e){e?this.handleClickDeleteComment():this.handleClose()}handleClickDeleteComment(){const e=new B.c,{deleteComment:t}=this.state,{apiId:n,intl:a,onDeleteComment:i}=this.props,o=t.id,s=t.parentCommentId;this.handleClose(),e.deleteComment(n,o).then((()=>{null===s?(i&&i(o),D.c.info(a.formatMessage({defaultMessage:"Comment has been successfully deleted",id:"Apis.Details.Comments.Comment.comment.deleted"}))):(this.handleDeleteReply(s,o),D.c.info(a.formatMessage({defaultMessage:"Reply comment has been successfully deleted",id:"Apis.Details.Comments.Comment.reply.comment.deleted"})))})).catch((e=>{console.error(e),e.response?D.c.error(e.response.body.message):D.c.error(a.formatMessage({defaultMessage:"Something went wrong while deleting comment",id:"Apis.Details.Comments.Comment.something.went.wrong"})+" - "+o)}))}handleLoadMoreReplies(e){const{apiId:t,comments:n,updateComment:a}=this.props,{id:i,replies:{count:o,list:s}}=e;(new B.c).getAllCommentReplies(t,i,3,o).then((e=>{if(e.body){const{list:t,count:r}=e.body,l=n.find((e=>e.id===i)),c=s.concat(t),m=o+r,d=m<=3?3:m,p=le(le({},l),{},{replies:{count:m,list:c,pagination:le(le({},l.replies.pagination),{},{limit:d})}});a&&a(p)}})).catch((e=>{}))}handleDeleteReply(e,t){const{comments:n,updateComment:a,apiId:i}=this.props,o=n.find((t=>t.id===e)),{replies:s}=o,r=s.list.filter((e=>e.id!==t)),l=s.pagination.total-1,c=s.pagination.limit>l?l:s.pagination.limit,m=s.count-1;if(l>m)(new B.c).getAllCommentReplies(i,e,1,c-1).then((e=>{if(e.body){const t=le(le({},o),{},{replies:le(le({},s),{},{list:[...r,...e.body.list],pagination:le(le({},s.pagination),{},{total:l})})});a&&a(t)}})).catch((e=>{}));else{const e=le(le({},o),{},{replies:le(le({},s),{},{count:m,list:r,pagination:le(le({},s.pagination),{},{limit:c,total:l})})});a&&a(e)}}handleAddReply(e){const{comments:t,updateComment:n}=this.props,{parentCommentId:a}=e,i=t.find((e=>e.id===a)),{replies:o}=i,s=(o.count||0)+1,r=s<=3?3:s,l=le(le({},i),{},{replies:le(le({},o),{},{count:s,list:[...o.list,e],pagination:le(le({},o.pagination),{},{limit:r,offset:o.pagination.offset||0,total:o.pagination.total+1})})});n&&n(l)}render(){const{comments:e,apiId:t,allComments:n,isOverview:i,isCrossTenantUser:o}=this.props,{editIndex:s,openDialog:r,replyId:c}=this.state;return a.createElement(pe,null,a.createElement("div",{className:S()({[de.paper]:!i&&e.length>0},{[de.cleanBack]:i})},e&&e.slice(0).map(((e,r)=>a.createElement("div",{key:e.id+"-"+r,className:S()({[de.contentWrapper]:!i},{[de.contentWrapperOverview]:i})},0!==r&&a.createElement(w.c,{className:de.divider}),a.createElement(m.cp,{md:8,container:!0,spacing:1,className:S()({[de.root]:!i})},a.createElement(m.cp,{item:!0},a.createElement(v.c,{className:de.commentIcon},"account_circle")),a.createElement(m.cp,{item:!0,xs:!0,zeroMinWidth:!0},a.createElement(l.c,{noWrap:!0,className:de.commentText},e.commenterInfo&&e.commenterInfo.firstName?e.commenterInfo.firstName+e.commenterInfo.lastName:e.createdBy),a.createElement(b.c,{title:e.createdTime,"aria-label":e.createdTime},a.createElement(l.c,{noWrap:!0,className:de.commentText,variant:"caption"},$()(e.createdTime).fromNow())),a.createElement(l.c,{className:de.commentText},e.content),!o&&a.createElement(ee,{comment:e,editIndex:s,index:r,showAddComment:this.showAddComment,handleClickOpen:this.handleClickOpen,showEditComment:this.showEditComment}),e.id===c&&a.createElement(p.c,{ml:6,mb:2},a.createElement(se,{apiId:t,replyTo:e.id,allComments:n,handleShowReply:this.handleShowReply,cancelButton:!0,addReply:this.handleAddReply})),e.replies&&e.replies.list.map(((n,i)=>a.createElement(a.Fragment,null,a.createElement(p.c,{ml:8},0!==i&&a.createElement(w.c,{className:de.divider}),a.createElement(m.cp,{container:!0,spacing:1,className:de.root},a.createElement(m.cp,{item:!0},a.createElement(v.c,{className:de.commentIcon},"account_circle")),a.createElement(m.cp,{item:!0,xs:!0,zeroMinWidth:!0},a.createElement(l.c,{noWrap:!0,className:de.commentText},n.commenterInfo&&n.commenterInfo.fullName?n.commenterInfo.fullName:n.createdBy),a.createElement(b.c,{title:e.createdTime,"aria-label":e.createdTime},a.createElement(l.c,{noWrap:!0,className:de.commentText,variant:"caption"},$()(n.createdTime).fromNow())),i!==s&&a.createElement(l.c,{className:de.commentText},n.content),i===s&&a.createElement(J,{apiId:t,allComments:n,comment:n,toggleShowEdit:this.handleShowEdit}),!o&&a.createElement(ee,{comment:n,editIndex:s,index:i,showAddComment:this.showAddComment,handleClickOpen:this.handleClickOpen,showEditComment:this.showEditComment}))))))),e.replies&&e.replies.count<e.replies.pagination.total&&a.createElement("div",{className:de.contentWrapper},a.createElement(m.cp,{container:!0,spacing:4,className:de.root},a.createElement(m.cp,{item:!0},a.createElement(l.c,{className:de.verticalSpace,variant:"body1"},a.createElement("a",{className:de.link+" "+de.loadMoreLink,onClick:()=>this.handleLoadMoreReplies(e),onKeyDown:()=>this.handleLoadMoreReplies(e)},a.createElement(h.c,{id:"Apis.Details.Comments.Comment.load.more.replies",defaultMessage:"Show More Replies"})))),a.createElement(m.cp,{item:!0},a.createElement(l.c,{className:de.verticalSpace,zvariant:"body1"},"("+e.replies.count+" of "+e.replies.pagination.total+")")))))))))),a.createElement(U,{key:"key-dialog",labelCancel:a.createElement(h.c,{id:"Apis.Details.Comments.Comment.delete.dialog.label.cancel",defaultMessage:"Cancel"}),title:a.createElement(h.c,{id:"Apis.Details.Comments.Comment.delete.dialog.title",defaultMessage:"Confirm Delete"}),message:a.createElement(h.c,{id:"Apis.Details.Comments.Comment.delete.dialog.message",defaultMessage:"Are you sure you want to delete this comment?"}),labelOk:a.createElement(h.c,{id:"Apis.Details.Comments.Comment.delete.dialog.label.ok",defaultMessage:"Yes"}),callback:this.handleConfirmDialog,open:r}))}}he.defaultProps={isOverview:!1},he.propTypes={classes:s().shape({}).isRequired,apiId:s().string.isRequired,allComments:s().instanceOf(Array).isRequired,comments:s().instanceOf(Array).isRequired,isOverview:s().bool,isCrossTenantUser:s().bool.isRequired,updateComment:s().func.isRequired};const ue=(0,u.cp)(he);var ge=n(47568);const Ce="CommentsLegacy",fe={root:`${Ce}-root`,paper:`${Ce}-paper`,contentWrapper:`${Ce}-contentWrapper`,contentWrapperOverview:`${Ce}-contentWrapperOverview`,titleSub:`${Ce}-titleSub`,link:`${Ce}-link`,verticalSpace:`${Ce}-verticalSpace`,loadMoreLink:`${Ce}-loadMoreLink`,genericMessageWrapper:`${Ce}-genericMessageWrapper`,paperProgress:`${Ce}-paperProgress`,button:`${Ce}-button`},ye=(0,i.cp)(ge.U.Consumer)((e=>{let{theme:t}=e;return{[`& .${fe.root}`]:{display:"flex",alignItems:"center",paddingTop:t.spacing(2),paddingBottom:t.spacing(2)},[`& .${fe.paper}`]:{marginRight:t.spacing(3),paddingBottom:t.spacing(3),paddingRight:t.spacing(2),"& span, & h5, & label, & td, & li, & div, & input":{color:t.palette.getContrastText(t.palette.background.paper)}},[`& .${fe.contentWrapper}`]:{paddingLeft:t.spacing(3),marginTop:t.spacing(1)},[`& .${fe.contentWrapperOverview}`]:{width:"100%",boxShadow:"none"},[`& .${fe.titleSub}`]:{cursor:"pointer",color:t.palette.getContrastText(t.palette.background.default)},[`& .${fe.link}`]:{color:t.palette.getContrastText(t.palette.background.default),cursor:"pointer"},[`& .${fe.verticalSpace}`]:{marginTop:t.spacing(.2)},[`& .${fe.loadMoreLink}`]:{textDecoration:"none"},[`& .${fe.genericMessageWrapper}`]:{marginTop:t.spacing(2),marginBottom:t.spacing(2),marginRight:t.spacing(3)},[`& .${fe.paperProgress}`]:{padding:t.spacing(3),marginTop:t.spacing(2)},[`& .${fe.button}`]:{textTransform:"capitalize"}}}));class be extends a.Component{constructor(e){super(e),this.state={expanded:!0,allComments:null,comments:[],totalComments:0,apiId:null,showCommentAdd:!1},this.handleExpandClick=this.handleExpandClick.bind(this),this.handleLoadMoreComments=this.handleLoadMoreComments.bind(this),this.toggleCommentAdd=this.toggleCommentAdd.bind(this),this.addComment=this.addComment.bind(this),this.updateComment=this.updateComment.bind(this),this.onDeleteComment=this.onDeleteComment.bind(this),this.isCrossTenant=this.isCrossTenant.bind(this)}componentDidMount(){let{apiId:e,match:t,intl:n,isOverview:a,setCount:i}=this.props;t&&(e=t.params.apiUuid),this.setState({apiId:e});const o=new B.c,s=this.props.commentsLimit;o.getAllComments(e,s,0).then((e=>{let t=e.body.list;a&&(i(t.length),t.length>2&&(t=t.slice(t.length-3,t.length))),this.setState({allComments:t,comments:t,totalComments:e.body.pagination.total})})).catch((e=>{}))}handleLoadMoreComments(){const{allComments:e,apiId:t,comments:n}=this.state,a=new B.c,i=this.props.commentsLimit,o=n.length;a.getAllComments(t,i,o).then((t=>{const n=e.concat(t.body.list);this.setState({allComments:n,comments:n})})).catch((e=>{}))}handleExpandClick(){const{expanded:e}=this.state;this.setState({expanded:!e})}addComment(e){const{totalComments:t,allComments:n}=this.state,a=t+1;this.setState({allComments:[e,...n],totalComments:a,comments:[e,...n]})}updateComment(e){const{comments:t}=this.state,n=t.reduce(((t,n)=>{let a=n;return n.id===e.id&&(a=e),[...t,a]}),[]);this.setState({allComments:n,comments:n})}onDeleteComment(e){const{apiId:t,comments:n,totalComments:a}=this.state,i=n.filter((t=>t.id!==e)),o=a-1;o>i.length?(new B.c).getAllComments(t,1,i.length).then((e=>{e.body&&this.setState({totalComments:o,comments:[...i,...e.body.list],allComments:[...i,...e.body.list]})})).catch((e=>{})):this.setState({totalComments:o,comments:i,allComments:i})}isCrossTenant(e,t){if(!t)return!1;let n=null;const a=e.name;if(a.includes("@")){const e=a.split("@");n=e[e.length-1]}else n="carbon.super";return t!==n}toggleCommentAdd(){this.setState((e=>({showCommentAdd:!e.showCommentAdd})))}render(){const{isOverview:e,tenantDomain:t}=this.props,{comments:n,allComments:i,totalComments:o,showCommentAdd:s}=this.state,c=Z.c.getUser()&&this.isCrossTenant(Z.c.getUser(),t);return a.createElement(ye,null,(t=>{let{api:u}=t;return a.createElement(p.c,{sx:t=>({paddingLeft:e?null:t.spacing(3),marginTop:e?null:t.spacing(3),width:e?"100%":null,boxShadow:e?"none":null})},!e&&a.createElement("div",{className:fe.root},a.createElement(l.c,{variant:"h4",component:"h2",className:fe.titleSub},o+" ",a.createElement(h.c,{id:"Apis.Details.Comments.title",defaultMessage:"Comments"}))),!c&&Z.c.getUser()&&a.createElement(p.c,{mt:2,ml:1},!s&&a.createElement(d.c,{color:"primary",size:"small",className:fe.button,startIcon:a.createElement(y.c,null),onClick:this.toggleCommentAdd},a.createElement(h.c,{id:"Apis.Details.Comments.write.a.new.comment",defaultMessage:"Write a New Comment"})),s&&a.createElement(se,{apiId:u.id,commentsUpdate:this.addComment,addComment:this.addComment,allComments:i,replyTo:null,cancelCallback:this.toggleCommentAdd,cancelButton:!0})),!i&&a.createElement(r.c,{className:fe.paperProgress},a.createElement(g.c,{size:24})),i&&0===o&&a.createElement(p.c,{mt:2,mb:2,ml:1},a.createElement(C.c,{type:"info",title:a.createElement(h.c,{id:"Apis.Details.Comments.no.comments",defaultMessage:"No Comments Yet"})},a.createElement(l.c,{component:"p"},a.createElement(h.c,{id:"Apis.Details.Comments.no.comments.content",defaultMessage:"No comments available for this API yet"})))),a.createElement(ue,{comments:n,isCrossTenantUser:c,apiId:u.id,allComments:i,onDeleteComment:this.onDeleteComment,updateComment:this.updateComment}),o>n.length&&a.createElement("div",{className:fe.contentWrapper},a.createElement(m.cp,{container:!0,spacing:4,className:fe.root},a.createElement(m.cp,{item:!0},a.createElement(l.c,{className:fe.verticalSpace,variant:"body1"},a.createElement("a",{className:fe.link+" "+fe.loadMoreLink,onClick:this.handleLoadMoreComments},a.createElement(h.c,{id:"Apis.Details.Comments.load.previous.comments",defaultMessage:"Show More"})))),a.createElement(m.cp,{item:!0},a.createElement(l.c,{className:fe.verticalSpace,variant:"body1"},"("+n.length+" of "+o+")")))))}))}}var ve,we,Ee,$e;ve=be,we="contextType",Ee=ge.U,(we="symbol"==typeof($e=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(we))?$e:String($e))in ve?Object.defineProperty(ve,we,{value:Ee,enumerable:!0,configurable:!0,writable:!0}):ve[we]=Ee,be.defaultProps={setCount:()=>{}},be.propTypes={classes:s().instanceOf(Object).isRequired,setCount:s().func};const ke=(0,u.cp)((0,f.c)((function(e){const{apiId:t,match:n,intl:i,isOverview:o,setCount:s,tenantDomain:r}=e,l=(0,c.c)();return a.createElement(be,{apiId:t,match:n,intl:i,isOverview:o,setCount:s,tenantDomain:r,commentsLimit:l.custom.commentsLimit})})))},362264:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,n="millisecond",a="second",i="minute",o="hour",s="day",r="week",l="month",c="quarter",m="year",d="date",p="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,u=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},C=function(e,t,n){var a=String(e);return!a||a.length>=t?e:""+Array(t+1-a.length).join(n)+e},f={s:C,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),a=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+C(a,2,"0")+":"+C(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var a=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(a,l),o=n-i<0,s=t.clone().add(a+(o?-1:1),l);return+(-(a+(n-i)/(o?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:m,w:r,d:s,D:d,h:o,m:i,s:a,ms:n,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=g;var v=function(e){return e instanceof k},w=function e(t,n,a){var i;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();b[o]&&(i=o),n&&(b[o]=n,i=o);var s=t.split("-");if(!i&&s.length>1)return e(s[0])}else{var r=t.name;b[r]=t,i=r}return!a&&i&&(y=i),i||!a&&y},E=function(e,t){if(v(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new k(n)},$=f;$.l=w,$.i=v,$.w=function(e,t){return E(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var k=function(){function g(e){this.$L=w(e.locale,null,!0),this.parse(e)}var C=g.prototype;return C.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if($.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var a=t.match(h);if(a){var i=a[2]-1||0,o=(a[7]||"0").substring(0,3);return n?new Date(Date.UTC(a[1],i,a[3]||1,a[4]||0,a[5]||0,a[6]||0,o)):new Date(a[1],i,a[3]||1,a[4]||0,a[5]||0,a[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},C.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},C.$utils=function(){return $},C.isValid=function(){return!(this.$d.toString()===p)},C.isSame=function(e,t){var n=E(e);return this.startOf(t)<=n&&n<=this.endOf(t)},C.isAfter=function(e,t){return E(e)<this.startOf(t)},C.isBefore=function(e,t){return this.endOf(t)<E(e)},C.$g=function(e,t,n){return $.u(e)?this[t]:this.set(n,e)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(e,t){var n=this,c=!!$.u(t)||t,p=$.p(e),h=function(e,t){var a=$.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return c?a:a.endOf(s)},u=function(e,t){return $.w(n.toDate()[e].apply(n.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},g=this.$W,C=this.$M,f=this.$D,y="set"+(this.$u?"UTC":"");switch(p){case m:return c?h(1,0):h(31,11);case l:return c?h(1,C):h(0,C+1);case r:var b=this.$locale().weekStart||0,v=(g<b?g+7:g)-b;return h(c?f-v:f+(6-v),C);case s:case d:return u(y+"Hours",0);case o:return u(y+"Minutes",1);case i:return u(y+"Seconds",2);case a:return u(y+"Milliseconds",3);default:return this.clone()}},C.endOf=function(e){return this.startOf(e,!1)},C.$set=function(e,t){var r,c=$.p(e),p="set"+(this.$u?"UTC":""),h=(r={},r[s]=p+"Date",r[d]=p+"Date",r[l]=p+"Month",r[m]=p+"FullYear",r[o]=p+"Hours",r[i]=p+"Minutes",r[a]=p+"Seconds",r[n]=p+"Milliseconds",r)[c],u=c===s?this.$D+(t-this.$W):t;if(c===l||c===m){var g=this.clone().set(d,1);g.$d[h](u),g.init(),this.$d=g.set(d,Math.min(this.$D,g.daysInMonth())).$d}else h&&this.$d[h](u);return this.init(),this},C.set=function(e,t){return this.clone().$set(e,t)},C.get=function(e){return this[$.p(e)]()},C.add=function(n,c){var d,p=this;n=Number(n);var h=$.p(c),u=function(e){var t=E(p);return $.w(t.date(t.date()+Math.round(e*n)),p)};if(h===l)return this.set(l,this.$M+n);if(h===m)return this.set(m,this.$y+n);if(h===s)return u(1);if(h===r)return u(7);var g=(d={},d[i]=e,d[o]=t,d[a]=1e3,d)[h]||1,C=this.$d.getTime()+n*g;return $.w(C,this)},C.subtract=function(e,t){return this.add(-1*e,t)},C.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var a=e||"YYYY-MM-DDTHH:mm:ssZ",i=$.z(this),o=this.$H,s=this.$m,r=this.$M,l=n.weekdays,c=n.months,m=function(e,n,i,o){return e&&(e[n]||e(t,a))||i[n].slice(0,o)},d=function(e){return $.s(o%12||12,e,"0")},h=n.meridiem||function(e,t,n){var a=e<12?"AM":"PM";return n?a.toLowerCase():a},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:r+1,MM:$.s(r+1,2,"0"),MMM:m(n.monthsShort,r,c,3),MMMM:m(c,r),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:m(n.weekdaysMin,this.$W,l,2),ddd:m(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:$.s(o,2,"0"),h:d(1),hh:d(2),a:h(o,s,!0),A:h(o,s,!1),m:String(s),mm:$.s(s,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:i};return a.replace(u,(function(e,t){return t||g[e]||i.replace(":","")}))},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(n,d,p){var h,u=$.p(d),g=E(n),C=(g.utcOffset()-this.utcOffset())*e,f=this-g,y=$.m(this,g);return y=(h={},h[m]=y/12,h[l]=y,h[c]=y/3,h[r]=(f-C)/6048e5,h[s]=(f-C)/864e5,h[o]=f/t,h[i]=f/e,h[a]=f/1e3,h)[u]||f,p?y:$.a(y)},C.daysInMonth=function(){return this.endOf(l).$D},C.$locale=function(){return b[this.$L]},C.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),a=w(e,t,!0);return a&&(n.$L=a),n},C.clone=function(){return $.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},g}(),M=k.prototype;return E.prototype=M,[["$ms",n],["$s",a],["$m",i],["$H",o],["$W",s],["$M",l],["$y",m],["$D",d]].forEach((function(e){M[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),E.extend=function(e,t){return e.$i||(e(t,k,E),e.$i=!0),E},E.locale=w,E.isDayjs=v,E.unix=function(e){return E(1e3*e)},E.en=b[y],E.Ls=b,E.p={},E}()},677336:function(e){e.exports=function(){"use strict";return function(e,t,n){e=e||{};var a=t.prototype,i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function o(e,t,n,i){return a.fromToBase(e,t,n,i)}n.en.relativeTime=i,a.fromToBase=function(t,a,o,s,r){for(var l,c,m,d=o.$locale().relativeTime||i,p=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],h=p.length,u=0;u<h;u+=1){var g=p[u];g.d&&(l=s?n(t).diff(o,g.d,!0):o.diff(t,g.d,!0));var C=(e.rounding||Math.round)(Math.abs(l));if(m=l>0,C<=g.r||!g.r){C<=1&&u>0&&(g=p[u-1]);var f=d[g.l];r&&(C=r(""+C)),c="string"==typeof f?f.replace("%d",C):f(C,a,g.l,m);break}}if(a)return c;var y=m?d.future:d.past;return"function"==typeof y?y(c):y.replace("%s",c)},a.to=function(e,t){return o(e,t,this,!0)},a.from=function(e,t){return o(e,t,this)};var s=function(e){return e.$u?n.utc():n()};a.toNow=function(e){return this.to(s(this),e)},a.fromNow=function(e){return this.from(s(this),e)}}}()}}]);
//# sourceMappingURL=APIComments.1e2951f842400e4fe313.bundle.js.map